<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    
    <!-- <script src="https://kit.fontawesome.com/8d5fec3580.js"></script> -->
    <script src="src/js/fontawesome/fontawesome.js"></script>
    <script src="node_modules/systemjs/dist/system.js"></script>
    <!-- <script src="node_modules/js-cookie/src/js.cookie.js"></script> -->
    <script src="src/js/instascan.min.js" type="text/javascript"></script>


    <title>WPI ESL CPMS - WPI ESL Conversation Partner Management System</title>

    <link type="text/css" rel="stylesheet" href="jquery-te-1.4.0.css">

    <!-- Bootstrap core CSS -->
    
    <link href="https://fonts.googleapis.com/css?family=Manjari&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="theme-bootstrap.css">
    <link rel="stylesheet" href="user.css">

    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.1/firebase-storage.js"></script>

    <!-- Custom styles for this template -->
    <style type="text/css">
        body {
            padding-top: 5rem;
        }

        .starter-template {
            padding: 3rem 1.5rem;
            text-align: center;
        }
    </style>
</head>

<script>
        /*************DO NOT MODIFY THIS BLOCK*************/
        // dynamic start
        let debugContent="2019-12-08 18:54:00";//dynamic generated time
        // dynamic end
        /*************DO NOT MODIFY THIS BLOCK*************/
        let debugTime = new Date(debugContent);
        let nowTime = new Date();
        let minutes = (nowTime - debugTime)/1000/60;
        console.log("build "+minutes.toFixed(2)+" minutes ago");
</script>
    
<body>

    <nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">
        <a class="navbar-brand" href="#">
            <img src="images/wpi_logo.png" class="nav-logo">

        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

        <div class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" id="reservationBtn">Reservation</a>
                </li>
                <!-- <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#">Disabled</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                    <div class="dropdown-menu" aria-labelledby="dropdown01">
                        <a class="dropdown-item" href="#">Action</a>
                        <a class="dropdown-item" href="#">Another action</a>
                        <a class="dropdown-item" href="#">Something else here</a>
                    </div>
                </li> -->
            </ul>
            
            <form class="form-inline my-2 my-lg-0">
                <!-- <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button> -->
                <!-- <input class="btn btn-outline-secondary"><div style="color: #eeeeee"><i class="fas fa-user"></i><span style="margin-left:10px;">Login/Signup</span></div></input> -->
                <div id="login_panel" class="d-none">
                <button type="button" class="btn btn-secondary" aria-label="Left Align" data-toggle="modal" data-target="#loginModal">
                        <span class="fas fa-user" aria-hidden="true" style="color: white;"> <span style="font-family: 'Manjari', sans-serif;">Join</span></span>
                      </button>
                </div>

                <div id="user_panel" class="d-none">
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="fas fa-user" aria-hidden="true" style="color: white;"></span><span style="font-family: 'Manjari', sans-serif; padding-left: 5px;">User</span>
                        </button>
                        <div class="dropdown-menu" id="user-panel-dropdown" aria-labelledby="dropdownMenuButton">
                          <div class="media dropdown-item">
                            <img style="cursor:pointer; width:50px;height: 50px;" id="avatar-edit-btn"  src="images/boy.png" class="mr-3 avatar-icon avatar-icon-update" alt="...">
                            <div class="media-body">
                              <h5 style="margin-bottom: 0px;" id="name_display_in_menu">Ray</h5>
                              <small style="cursor:pointer;" class="text-muted" id="role_display_in_menu">student</small>
                            </div>
                          </div>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#" id="newTalkMenuBtn">Create Talk</a>
                          <a class="dropdown-item" href="#" id="joinTalkMenuBtn">Join Talk</a>
                          <a class="dropdown-item" href="#" id="checkRecordMenuBtn">Check Records</a>
                          <div class="dropdown-divider" id="manageConsoleBtnDivier"></div>
                          <a class="dropdown-item" href="#" id="manageConsoleBtn">Console</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" id="account-setting-btn" href="#">Account Settings</a>
                          <a class="dropdown-item" href="#">Preferences</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#" id='logout_btn'>Log out</a>
                        </div>
                      </div>
                </div>


            </form>

        </div>
    </nav>
    <div style="margin:-21px"></div>
    <div class="jumbotron jumbotron-fluid hero-img" style="
        padding-top: 100px;
        padding-bottom: 100px;">
            <div class="hero-img-overlay"></div>
            <div class="container">
              <h1 class="display-6 hero-title">Welcome to ESL</h1>
              <p class="lead hero-title-desc">We aim to provide you the best experience in learning English.</p>
            </div>
          </div>


    <main role="main" class="container">
        <div style="background:#f5f8fd;padding: 20px;" class="section-shadow">
                <h3>Conversation Partner Management System</h3>
                <div class="row">
                    <div class="col-md-4 col-sm-12" style="margin-bottom:5px;">
                            <div class="card" style="width: 100%; height:12rem;">
                                    <!-- <img src="..." class="card-img-top" alt="..."> -->
                                    <div class="card-body">
                                      <h5 class="card-title"><i class="far fa-hand-paper" style="margin-right: 10px;"></i>Request</h5>
                                      <p class="card-text">Make a request to start a new conversation.</p>
                                      <a href="#" class="btn btn-primary btn-block" style="font-size:14px;" id="startConverstionBtn">Start Conversation</a>
                                    </div>
                                  </div>
                    </div>

                    <div class="col-md-4 col-sm-12" style="margin-bottom:5px;">
                            <div class="card" style="width: 100%; height:12rem;">
                                    <!-- <img src="..." class="card-img-top" alt="..."> -->
                                    <div class="card-body">
                                      <h5 class="card-title"><i class="fas fa-hands-helping" style="margin-right: 10px;"></i>Response</h5>
                                      <p class="card-text">Response to a conversation initialized before. </p>
                                      <a href="#" class="btn btn-primary btn-block" style="font-size:14px;" id="joinConversationBtn">Join Conversation</a>
                                    </div>
                                  </div>
                    </div>

                    <div class="col-md-4 col-sm-12" style="margin-bottom:5px;">
                            <div class="card" style="width: 100%; height:12rem;">
                                    <!-- <img src="..." class="card-img-top" alt="..."> -->
                                    <div class="card-body">
                                      <h5 class="card-title"><i class="far fa-clipboard" style="margin-right: 10px;"></i>Records</h5>
                                      <p class="card-text">The history records of conversation initialized before. </p>
                                      <a href="#" class="btn btn-primary btn-block" style="font-size:14px;" id="checkRecordBtn">Check Records</a>
                                    </div>
                                  </div>
                    </div>
            </div>
        </div>

        <div style="background:#f5f8fd;padding: 20px; margin-top: 20px;" class="section-shadow">
                <h3>Announcements</h3>
                <div class="list-group" id="anouncement_list" style="margin-bottom:10px;">
                        
                        <!-- <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">Dapibus ac facilisis in
                          <span class="badge badge-primary badge-pill">NEW</span>
                        </a> -->
                        <a href="#" annid="1" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">Dapibus ac facilisis in
                            <small class="text-muted">1 day ago</small>
                          </a>
                      
                        <!-- <a href="#" class="list-group-item list-group-item-action disabled" tabindex="-1" aria-disabled="true">Vestibulum at eros</a> -->
                      </div>
                      <nav aria-label="...">
                        <ul class="pagination" id="annoucement_pagination">
                          <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1">Previous</a>
                          </li>
                          <li class="page-item"><a class="page-link" href="#">1</a></li>
                          <li class="page-item active">
                            <a class="page-link" href="#">2</a>
                          </li>
                          <li class="page-item"><a class="page-link" href="#">3</a></li>
                          <li class="page-item">
                            <a class="page-link" href="#">Next</a>
                          </li>
                        </ul>
                      </nav>
                <!-- <div style="margin-top:10px;display: flex;justify-content:flex-end;">
                      <a class="btn btn-primary" href="#" role="button">All Anouncements</a>
                </div> -->
        </div>

        <div style="background:#f5f8fd;padding: 20px; margin-top: 20px;" class="section-shadow">
                
          <div style="margin-top:10px;display: flex;justify-content:space-between;"><span class="h3">Discussions</span> <button type="button" class="btn btn-primary" style="height:32px;padding-top: 0px;padding-bottom: 0px;" id="newPostBtn"><i class="fas fa-plus-circle" style="margin-right:5px;"></i>New Post</button></div>
                
                <div class="card text-center">
                        <div class="card-header">
                          <ul class="nav nav-tabs card-header-tabs">
                            <li class="nav-item">
                              <a class="nav-link active" href="#">All</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" href="#">My Post</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Replies</a>
                            </li>
                          </ul>
                        </div>
                        <div class="card-body">
                          <!-- <h5 class="card-title">Special title treatment</h5>
                          <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                          <a href="#" class="btn btn-primary">Go somewhere</a> -->

                          <div style="margin-bottom:10px;" id="all_discussion_list">
                          <a href="#" annid="1" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"><span><img style="cursor:pointer; width:30px;height: 30px;"   src="images/boy.png" class="mr-3 avatar-icon avatar-icon-update" alt="...">Dapibus ac facilisis in</span>
                            <small class="text-muted d-sm-none d-md-block">1 day ago</small>
                          </a>

                          <a href="#" annid="1" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">Dapibus ac facilisis in
                            <small class="text-muted">1 day ago</small>
                          </a>

                          <a href="#" annid="1" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">Dapibus ac facilisis in
                            <small class="text-muted">1 day ago</small>
                          </a>
                        </div>

                          <nav aria-label="...">
                            <ul class="pagination" id="discussion_allposts_pagination">
                              <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1">Previous</a>
                              </li>
                              <li class="page-item"><a class="page-link" href="#">1</a></li>
                              <li class="page-item active">
                                <a class="page-link" href="#">2 <span class="sr-only">(current)</span></a>
                              </li>
                              <li class="page-item"><a class="page-link" href="#">3</a></li>
                              <li class="page-item">
                                <a class="page-link" href="#">Next</a>
                              </li>
                            </ul>
                          </nav>
                          


                        </div>
                      </div>
                <!-- <div style="margin-top:10px;display: flex;justify-content:flex-end;">
                      <a class="btn btn-primary" href="#" role="button">All Anouncements</a>
                </div> -->
        </div>

        

        

        <!-- <div class="starter-template">
            <h1>Bootstrap starter template</h1>
            <p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.</p>
        </div> -->

    </main>


    
    <footer style="min-height: 100%;margin-top: 20px;">
        <div style="background:#333333;height:60px;padding: 10px;">
            <div style="font-size:14px;color:#888888;">International House@WORCESTER POLYTECHNIC INSTITUTE</div>
            <div class="lead" style="font-size:12px;color:#888888;">Worcester, MA | 01609-2280
                    Ph: <span style="text-decoration:underline">508-831-5000</span></div>
        </div>
    </footer>

    <!-- /.container -->




    <!-- Login modal starts here -->

    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title font-red" id="loginModalLabel">Welcome to Join Us!</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                
                <div class="modal-body">
                <!-- login content starts -->
                <small id="login_first_error" style="color:red;">Please log in first.</small>  
                <div id="WPI-login-content">
                  Your WPI Email:
                  <div class="input-group">
                      
                        <input type="text" class="form-control" id="wpi-username-login-input" placeholder="WPI username" aria-label="Recipient's username" aria-describedby="basic-addon2">
                        <div class="input-group-append">
                          <span class="input-group-text" id="basic-addon2">@wpi.edu</span>
                        </div>

            
                </div>
                <small id="email_login_error" class="form-text  mb-3" style="color:red;"></small>

                <div class="form-group">
                        <label for="exampleInputPassword1">Password:</label>
                        <input type="password" class="form-control"  id="user-login-password-input" placeholder="ESL Password, not your bannerweb password.">
                        <small id="password_login_error" class="form-text mb-3" style="color:red;"></small>
                        <small id="login_credential_error" class="form-text mb-3" style="color:red;"></small>
                      </div>
                      

                <div style="font-size:14px;text-align: center;">
                        <p class="font-red" style="text-decoration-line: underline; margin-bottom: 0px;cursor: pointer;">Forget my password.</p>
            
                        <p style="font-size:14px; margin-top: 0px;margin-bottom: 0px;">Or</p>
        
                        <p class="font-red go-to-reg" style="text-decoration-line: underline; margin-top: 0px;cursor: pointer;">I am a new member in ESL.</p>
                
                </div>    
              </div>  
                

                 <!-- login content ends      -->


                 <!-- signup content starts -->
                <div id="WPI-Reg-content">
                    Your WPI Email:
                    <div class="input-group">
                            <input type="text" class="form-control" id="wpi-username-verify-input" placeholder="Your username" aria-label="Your username" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                            <span class="input-group-text" id="basic-addon2">@wpi.edu</span>
                            </div>
                    </div>
                    <!-- <small class="mb-3" style="color:red;">Account exists. Please login.</small> -->

                    <p class="font-red go-to-login" style="font-size:14px;text-align: center;text-decoration-line: underline;cursor: pointer;">I already have an ESL account.</p>
                </div>
                <!-- signup content ends      -->

                <!-- verify email starts -->
                <div id="WPI-Verify-content">
                    Verification Code:
                    <div class="input-group mb-3">
                            <input type="text" id="verification-code-input" class="form-control" placeholder="Please input the 4-digit verification code" aria-label="Please input the 4-digit verification code" aria-describedby="basic-addon2">
                            </div>
                    

                <div style="text-align: center;font-size:14px">
                    <p class="font-red" style="text-decoration-line: underline; margin-bottom: 0px;cursor: pointer;">Change email</p>
            
                    <p style="margin-top: 0px;margin-bottom: 0px;">Or</p>

                    <p class="font-red" style="text-decoration-line: underline; margin-bottom: 0px;cursor: pointer;">Resend verification code <span>(wait for 30 seconds)</span></p>
            
                    <p style="margin-top: 0px;margin-bottom: 0px;">Or</p>

                    <p class="font-red go-to-login" style="font-size:14px;text-decoration-line: underline;cursor: pointer;">I already have an ESL account.</p>
                </div>
                
                  </div>
                <!-- verify email ends      -->


                <!-- setup password starts -->
                <div id="WPI-Password-content">

                  Password:
                  <div class="input-group mb-3">
                          <input type="text" id="password-set-input" class="form-control" placeholder="Please input your new password." aria-label="Please input the 4-digit verification code" aria-describedby="basic-addon2">
                          </div>

                  Confirm Password:
                  <div class="input-group mb-3">
                    <input type="text" id="password-repeat-input" class="form-control" placeholder="Input your password again." aria-label="Please input the 4-digit verification code" aria-describedby="basic-addon2">
                    </div>
                  

              <!-- <div style="text-align: center;font-size:14px">
                  <p class="font-red" style="text-decoration-line: underline; margin-bottom: 0px;">Change email</p>
          
                  <p style="margin-top: 0px;margin-bottom: 0px;">Or</p>

                  <p class="font-red" style="text-decoration-line: underline; margin-bottom: 0px;">Resend verification code <span>(wait for 30 seconds)</span></p>
          
                  <p style="margin-top: 0px;margin-bottom: 0px;">Or</p>

                  <p class="font-red go-to-login" style="font-size:14px;text-decoration-line: underline;">I already have an ESL account.</p>
              </div> -->
              
                </div>
              <!-- setup password ends      -->



                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary" id="login-reg-confirm">Save changes</button>
                </div>
              </div>
            </div>
          </div>



    <!-- Login modal ends here -->


    <!-- qr generate model starts here -->
    <div class="modal fade" id="qrGenerateModal" tabindex="-1" role="dialog" aria-labelledby="qrGenerateLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title font-red" id="qrGenerateLabel">Scan to Join</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          
          <div class="modal-body">
          <!-- qr generate content starts -->
          <div class="card" style="width: 18rem; margin-left: auto;margin-right: auto;">
            <img src="..." class="card-img-top" alt="...">
            <!-- <div class="card-body">
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div> -->
          </div>
          <!-- qr generate content ends -->
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-primary">Use Code</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    <!-- qr generate model ends here -->



    <!-- qr scanner model starts here -->
    <div class="modal fade" id="qrScannerModal" tabindex="-1" role="dialog" aria-labelledby="qrScannerLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title font-red" id="qrScannerLabel">Please Scan</h5>
            <button type="button" class="close" id="qrScannerExitBtn" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          
          <div class="modal-body" style="height: 250px;" id="scannerHeight">

            <div id="scannerContent" style="height:100%">
          <!-- qr scanner content starts style="width: 100%;height:100%;" -->
          <video id="qr-video" style="width: 100%;" poster="images/video-tag-poster.png" muted playsinline></video>

          <!-- src="scan.html" -->
          <iframe  id="scannerIframe" frameBorder="0" style="width: 100%;height: 100%" scrolling="no"></iframe>
          
          <!-- qr scanner content ends -->
          </div>

          <div id="inputCodeContent">
              Input Code:
              <div class="input-group mb-3">
                  <input type="text" id="verify-code-input" class="form-control" placeholder="Please input the code." aria-label="Please input the code." aria-describedby="basic-addon2">
                </div>
          </div>




          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" id="changeJoinMethodBtn">Use Code</button>
            <button type="button" class="btn btn-primary">Join</button>
          </div>
        </div>
      </div>
    </div>
    <!-- qr scanner model ends here -->





    <!-- conversatonResultModal model starts here -->
    <div class="modal fade" id="conversatonResultModal" tabindex="-1" role="dialog" aria-labelledby="conversatonResultLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title font-red" id="conversatonResultLabel">Let's Chat!</h5>
            <button type="button" class="close" id="conversatonResultExitBtn" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          
          <div class="modal-body" style="height: 250px;">

            <div id="conversatonResultContent" style="height:100%">
          <!-- qr scanner content starts style="width: 100%;height:100%;" -->
          <div id="debugGroupInfo"></div>
          <p style="font-weight:bold">Members</p>

              <ul class="list-unstyled">
                <li class="media">
                  <img src="images/boy.png" class="mr-3 avatar-icon" alt="...">
                  <div class="media-body">
                    <h5 class="mt-0 mb-1">Ray</h5>
                    Challenge everything.
                    <p style="color: #888888;font-size:14px">shou@wpi.edu</p>
                  </div>
                </li>
                <li class="media">
                  <img src="images/girl.png" class="mr-3 avatar-icon" alt="...">
                  <div class="media-body">
                    <h5 class="mt-0 mb-1">Mike</h5>
                    Nice to meet ya.
                    <p style="color: #888888;font-size:14px">mike@wpi.edu</p>
                  </div>
                </li>
              </ul>
          
          
          <!-- qr scanner content ends -->
          </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="startConversationProcessBtn">Start!</button>
          </div>
        </div>
      </div>
    </div>
    <!-- conversatonResultModal model ends here -->



<!-- generic yes/no model starts here -->
<div class="modal fade" id="yesNoModal" tabindex="-1"  role="dialog" aria-labelledby="yesNoLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title font-red" id="yesNoLabel">Confirm</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <div class="modal-body" id="yesNo-modal-content">
        
        </div>
        <div class="modal-footer">
            <button type="button" class="btn" id="modalYES">Yes</button>
          <button type="button" class="btn" data-dismiss="modal" id="modalNO">No</button>
        </div>
      </div>
    </div>
  </div>
  <!-- yes/no model ends here -->



  <!-- edit personal information model starts here -->
<div class="modal fade" id="editPersonalInfoModal"  tabindex="-1" role="dialog" aria-labelledby="editPersonalInfoLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title font-red" id="editPersonalInfoLabel">Personal Information</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <div class="modal-body" id="editPersonalInfo-content">
            <form id="studentAndPartnerInfoForm">
                <div class="form-group">
                  <label for="userEmailAddressReadonly">Email address</label>
                  <input type="email" readonly class="form-control-plaintext" id="userEmailAddressReadonly" aria-describedby="emailHelp" placeholder="myemail@wpi.edu">
                  <!-- <small id="emailHelp" class="form-text text-muted">Email cannot be modified.</small> -->
                </div>
                <div class="form-group">
                  <label for="studentFirstNameInput">First Name</label>
                  <input type="text" class="form-control" id="studentFirstNameInput" placeholder="">
                  <small class="text-muted">Your name will be displayed in discussions.</small>
                </div>
                
                <div class="form-group">
                    <label for="studentMiddleNameInput">Middle Name(Optional)</label>
                    <input type="text" class="form-control" id="studentMiddleNameInput" placeholder="">
                  </div>
                <div class="form-group">
                    <label for="studentLastNameInput">Last Name</label>
                    <input type="text" class="form-control" id="studentLastNameInput" placeholder="">
                  </div>
                <div class="form-group">
                    <label for="majorInput">Major</label>
                    <input type="text" class="form-control" id="majorInput" placeholder="">
                  </div>
                
                <div class="form-group">
                    <label for="countryInput">Country / Regions</label>
                    <select class="form-control" id="country_select">
                        <option>Default select</option>
                      </select>
                      <small class="text-muted">This will help us to personalize your learning experiences.</small>
                  </div>

                  <div class="form-group">
                    <label for="countryInput">Access Control</label>
                    <select class="form-control" id="info_visible_select">
                        <option value="NONE">Keep all information private</option>
                        <option value="T">Only teachers can see</option>
                        <option value="TS" selected>Teachers and classmates can see (Recommended)</option>
                        <option value="ALL">Public to everyone</option>
                      </select>
                      <small class="text-muted">Your activity will not be affected.</small>
                  </div>

                  

                <!-- <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="exampleCheck1">
                  <label class="form-check-label" for="exampleCheck1">information visible to classmates.</label>
                </div> -->
                
              </form>

              <form id="adminInfoForm" class="d-none">
                  <div class="form-group">
                    <label for="adminEmailAddressReadonly">Email address</label>
                    <input type="email" readonly class="form-control-plaintext" id="adminEmailAddressReadonly" aria-describedby="emailHelp" placeholder="myemail@wpi.edu">
                    <!-- <small id="emailHelp" class="form-text text-muted">Email cannot be modified.</small> -->
                  </div>
                  <div class="form-group">
                    <label for="adminFirstNameInput">First Name</label>
                    <input type="text" class="form-control" id="adminFirstNameInput" placeholder="">
                  </div>
                  <div class="form-group">
                      <label for="adminMiddleNameInput">Middle Name(Optional)</label>
                      <input type="text" class="form-control" id="adminMiddleNameInput" placeholder="">
                    </div>
                  <div class="form-group">
                      <label for="adminLastNameInput">Last Name</label>
                      <input type="text" class="form-control" id="adminLastNameInput" placeholder="">
                    </div>
                  
                </form>

                <small style="color:red;" id="personal_info_edit_error">Error found.</small>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="editPersonalInfoSave">Save</button>
          <button type="button" class="btn btn-secondary"  id="editPersonalInfoDiscard">Discard</button>
        </div>
      </div>
    </div>
  </div>
  <!-- edit personal information model ends here -->


  <!-- avatar model starts here -->
<div class="modal fade" id="avatarEditModal" tabindex="-1"  role="dialog" aria-labelledby="avatarEditLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title font-red" id="avatarEditLabel">Confirm</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      
      <div class="modal-body" id="avatarEdit-modal-content">
      <!-- content start -->
          <div class="card" style="width: 100%;">
              <img src="images/boy.png" style="cursor:pointer" class="card-img-top image-edit-preview" alt="..." id="imageEditPreview">
              
              <div class="card-body" style="margin:0 auto">
                <a href="#" class="card-link" id="avatarUploadBtn">Upload Image</a>
                <a href="#" class="card-link">Choose Default Avatar</a>
                <small style="color:red;display:block" class="d-none" id="avatar-size-error">The maximum size of the image is 1MB</small>
              </div>
              
              <div class="progress d-none" style="height: 20px;" id="imageUploadProgressBarDiv">
                  <div class="progress-bar" id="imageUploadProgressBar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
            <input type="file" value="upload" id="avatarUpload" class="d-none" accept="image/jpeg">
        
      </div>
      
      <!-- content ends -->
      <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="avatarEditSave">Change</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal" id="modalNO">Discard</button>
      </div>
    </div>
  </div>
</div>
<!-- avatar model ends here -->


<!-- generic yes/no model starts here -->
<div class="modal fade" id="SafeConnectionModal" data-backdrop="static" data-keyboard="false" tabindex="-1"  role="dialog" aria-labelledby="ConnectionLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title font-red" id="ConnectionLabel">Security Firewall</h5>
        <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close"> -->
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      
      <div class="modal-body" id="Connection-modal-content">
          To keep you safe in use, please wait for 5 seconds to ensure no malware is running.
      </div>
      <div class="modal-footer">
          <!-- <button type="button" class="btn" id="modalConnection">Yes</button>
        <button type="button" class="btn" data-dismiss="modal" id="modalNO">No</button> -->
      </div>
    </div>
  </div>
</div>
<!-- yes/no model ends here -->

<!-- discussion detail model starts here -->
<div class="modal fade" id="discussionDetailModal" data-backdrop="static" data-keyboard="false" tabindex="-1"  role="dialog" aria-labelledby="discussionDetailLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title font-red" id="discussionDetailLabel">Loading title ...</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      
      <div class="modal-body" >
          <div id="discussionDetailContent">discussion details</div>
          
      </div>
      <div class="modal-body" >
        <div class="card">
            <div class="card-body">
                <p><strong>Comments</strong></p>
                <hr>
                <div style="overflow-y:hidden;">
                <div class="media" style="margin-bottom:10px;">
                    <img style="cursor:pointer; width:30px;height: 30px;"   
                    src="images/boy.png" class="mr-3 avatar-icon avatar-icon-update" alt="...">
                    <div class="media-body">
                      <h5 class="mt-0" style="font-size:16px;">Ray Hou
                      <p class="text-muted" style="font-size:12px;margin-bottom: 4px;">2019-11-08 22:15:02</p>
                      </h5>
                      <span class="text-muted" style="font-size:14px">Glad to see you.</span>
                    </div>
                  </div>
                </div>

                  
            </div>
          </div>

          <div class="card" style="margin-top:5px;">
              <div class="card-body" style="padding-bottom: 0px;">

                  <div class="form-group">
                      <label for="replyToDiscussion">Post Comment</label>
                      <textarea class="form-control" id="replyToDiscussion" rows="3"></textarea>
                      <div style="margin-top:5px;display: flex;justify-content:flex-end"><button type="submit" class="btn btn-primary mb-2">Submit</button></div>
                    </div>
              </div>
            </div>


      </div>
      
    
    </div>
  </div>
</div>
<!-- discussion model ends here -->


<!-- announcement detail model starts here -->
<div class="modal fade" id="announcementDetailModal" data-backdrop="static" data-keyboard="false" tabindex="-1"  role="dialog" aria-labelledby="announcementDetailLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title font-red" ><span id="announcementTitle">Loading title ...</span>
            <p style="margin-bottom: 0px;"><small class="text-muted" id="announcementAddtionalInfo">loading...</small></p>
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <div class="modal-body" >
            <div id="announcementDetailContent">loading details ...</div>
            
        </div>
        <div class="modal-body" >
            <div class="card" style="margin-top:5px;height:200px;">
                <div class="card-body">
  
                    <div class="form-group">
                        <label for="replyToDiscussion">send message</label>
                        <textarea class="form-control" id="replyToDiscussion" rows="3"></textarea>
                        <div style="margin-top:5px;display: flex;justify-content:flex-end"><button type="submit" class="btn btn-primary mb-2">Submit</button></div>
                      </div>
                </div>
              </div>
        
      
      </div>
    </div>
  </div>
  </div>
  <!-- announcement model ends here -->

  <!-- new discussion model starts here -->
<div class="modal fade" id="newDiscussionModal" data-backdrop="static" data-keyboard="false" tabindex="-1"  role="dialog" aria-labelledby="newDiscussionLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title font-red" ><span id="newDiscussionTitle">New Discussion</span>
            <p style="margin-bottom: 0px;"><small class="text-muted" id="newDiscussionAddInfo">Today</small></p>
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        
        <div class="modal-body" >
            <div id="newDiscussionContent">
                <div class="form-group">
                    <input type="text" class="form-control" id="discussionTopicInput" aria-describedby="emailHelp" placeholder="Topic">
                    <small id="disTopicError" class="form-text" style="color:red;">topic cannot be empty</small>
                    <textarea class="form-control" id="textAreaNewDiscussion" rows="3"></textarea>
                    <small id="disContentError" class="form-text" style="color:red;">content cannot be empty</small>
                    <!-- <div style="margin-top:5px;display: flex;justify-content:flex-end"><button type="submit" class="btn btn-primary mb-2">Submit</button></div> -->
                  </div>
            </div>
            
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="newDiscussionSubmit">Submit</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="newDiscussionCancel">Cancel</button>
        </div>
        
    </div>
  </div>
  </div>
  <!-- new discussion model ends here -->


<!-- scheduleModal model starts here -->
<div class="modal fade" id="scheduleModal" data-backdrop="static" data-keyboard="false" tabindex="-1"  role="dialog" aria-labelledby="scheduleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title font-red" id="scheduleModalLabel">Reservation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      
      <div class="modal-body" id="scheduleModal-content">
        <div id="data">
        <div class="row">
          <div class="col-4">
            <div class="list-group" id="list-tab" role="tablist">
              <a class="list-group-item list-group-item-action active" id="reserv_1" data-toggle="list" href="#list-reserv_1" role="tab" aria-controls="home">Sun.</a>
              <a class="list-group-item list-group-item-action" id="reserv_2" data-toggle="list" href="#list-reserv_2" role="tab" aria-controls="profile">Mon.</a>
              <a class="list-group-item list-group-item-action" id="reserv_3" data-toggle="list" href="#list-reserv_3" role="tab" aria-controls="messages">Tue.</a>
              <a class="list-group-item list-group-item-action" id="reserv_4" data-toggle="list" href="#list-reserv_4" role="tab" aria-controls="settings">Wed.</a>
              <a class="list-group-item list-group-item-action" id="reserv_5" data-toggle="list" href="#list-reserv_5" role="tab" aria-controls="settings">Thu.</a>
              <a class="list-group-item list-group-item-action" id="reserv_6" data-toggle="list" href="#list-reserv_6" role="tab" aria-controls="settings">Fri.</a>
              <a class="list-group-item list-group-item-action" id="reserv_7" data-toggle="list" href="#list-reserv_7" role="tab" aria-controls="settings">Sat.</a>
            </div>
          </div>
          <div class="col-8">
            <div class="tab-content" id="nav-tabContent">
              <div class="tab-pane fade show active" id="list-reserv_1" role="tabpanel" aria-labelledby="list-home-list">
                <!-- sunday -->
                <ul class="list-unstyled">
                  <li class="media">
                    <div class="fas fa-calendar-week mr-3"></div>
                    <div class="media-body">
                      <h5 class="mt-0 mb-1">December 8</h5><span style="color:green">Finished</span>
                      <p><div class="fas fa-comments" style="margin-left:5px;"></div> <span>Topic</span></p>
                      <p class="text-muted">This is the topic area</p>
                      <p><div class="fas fa-user" style="margin-left:5px;"></div> <span>Student</span></p>
                      <p class="text-muted">This is the student name</p>
                      <p><div class="fas fa-map-marker-alt" style="margin-left:5px;"></div> <span>Venue</span></p>
                      <p class="text-muted">This is the venue</p>
                      <p><div class="fas fa-stopwatch" style="margin-left:5px;"></div> <span>Time</span></p>
                      <p class="text-muted">This is the time</p>
                      
                    </div>
                  </li>
          
                </ul>
              </div>
              <div class="tab-pane fade" id="list-reserv_2" role="tabpanel" aria-labelledby="list-profile-list">...</div>
              <div class="tab-pane fade" id="list-reserv_3" role="tabpanel" aria-labelledby="list-messages-list">...</div>
              <div class="tab-pane fade" id="list-reserv_4" role="tabpanel" aria-labelledby="list-settings-list">...</div>
              <div class="tab-pane fade" id="list-reserv_5" role="tabpanel" aria-labelledby="list-settings-list">...</div>
              <div class="tab-pane fade" id="list-reserv_6" role="tabpanel" aria-labelledby="list-settings-list">...</div>
              <div class="tab-pane fade" id="list-reserv_7" role="tabpanel" aria-labelledby="list-settings-list">...</div>
            </div>
          </div>
        </div>
      </div>
      </div>
      <div class="modal-footer">
          <button type="button" class="btn" id="modalConnection">Yes</button>
        <button type="button" class="btn" data-dismiss="modal" id="modalNO">No</button>
      </div>
    </div>
  </div>
</div>
<!-- scheduleModal ends here -->



  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyBll_TlDEIa17btF05Vi2FhsxaR22HBdas",
      authDomain: "esl-platform-ca6b6.firebaseapp.com",
      databaseURL: "https://esl-platform-ca6b6.firebaseio.com",
      projectId: "esl-platform-ca6b6",
      storageBucket: "esl-platform-ca6b6.appspot.com",
      messagingSenderId: "629764141551",
      appId: "1:629764141551:web:2bd480f19afea37f09861a"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
  </script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="src/js/jquery-te-1.4.0.min.js" charset="utf-8"></script>
    <script src="src/js/qr/jsQR.js"></script>
    <!-- <script type="text/javascript" src="src/js/qr/require.js"></script> -->

    <script type="module">
      import QrScanner from "./src/js/scanner/qr-scanner.min.js";
      QrScanner.WORKER_PATH = './src/js/scanner/qr-scanner-worker.min.js';


      // get current platform

      let browserPlatformIndexChecker={
      versions:function(){
          var u = navigator.userAgent, app = navigator.appVersion;
          return {
              trident: u.indexOf('Trident') > -1, //IE
              presto: u.indexOf('Presto') > -1, //opera
              webKit: u.indexOf('AppleWebKit') > -1, //
              gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1,//
              mobile: !!u.match(/AppleWebKit.*Mobile.*/), //
              ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios
              android: u.indexOf('Android') > -1 || u.indexOf('Adr') > -1, //android
              iPhone: u.indexOf('iPhone') > -1 , //iPhoneQQHD
              iPad: u.indexOf('iPad') > -1, //iPad
              webApp: u.indexOf('Safari') == -1, //web
              weixin: u.indexOf('MicroMessenger') > -1, // 2015-01-22
          };
      }(),
      language:((navigator).browserLanguage || navigator.language).toLowerCase()
    }

    if(browserPlatformIndexChecker.versions.ios){
      localStorage.setItem("isIOS", "y");
    }
    else{
      localStorage.setItem("isIOS", "n");
    }


      //end platform


      
      if(localStorage.getItem("isIOS") == "y"){
        console.log("simulate in ios");
      }
      else{
        console.log("simulate in android");
      }

      const video = document.getElementById('qr-video');

      function setResult(result) {
          console.log("result=",result);
      }

      // ####### Web Cam Scanning #######

      if(localStorage.getItem("isIOS", "n") == "y"){
        //IOS
        //scannerIframe
        $('#scannerIframe').remove();
        window.QrScanner = QrScanner;

        QrScanner.hasCamera().then((hasCamera) => {console.log("has camera?",hasCamera)});

        window.scanner = new QrScanner(video, result => console.log('decoded qr code:', result));

        // scanner.start();

      }
      else{
        //non-IOS
        $('#qr-video').remove();
      }
      
    
    </script>

    <script>
        // setup camera

        // let scanner = new Instascan.Scanner({ video: document.getElementById('scanner') });
        // scanner.addListener('scan', function (content) {
        //   console.log(content);
        // });
        // Instascan.Camera.getCameras().then(function (cameras) {
        //   if (cameras.length > 0) {
        //     scanner.start(cameras[0]);
        //   } else {
        //     console.error('No cameras found.');
        //   }
        // }).catch(function (e) {
        //   console.error(e);
        // });


        //custom code

        let url = window.location.href;
        let baseURL = "";
        if(url.startsWith('https://songlinhou.github.io')){
          baseURL = url.replace("https://songlinhou.github.io","").replace("/index.html","");
          if(baseURL.endsWith("/")){
            baseURL = baseURL.substring(0,baseURL.length-1);
          }
        }
        else{
          baseURL = "/";
        }
        console.log("baseURL=",baseURL);
        localStorage.setItem("reload","yes");

        SystemJS.config({
          // baseURL: '/ESL-CPMS',
          baseURL: baseURL,
          packages: {
            '/':{
              defaultExtension: 'js'
            }
          }
        });

        SystemJS.import('src/js/app.js');
    
    </script>

    <!-- test purpose: JSCONSOLE -->

</body>
</html>